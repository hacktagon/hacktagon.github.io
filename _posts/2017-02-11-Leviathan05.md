---
layout: post
title: "Leviathan05"
headline: Leviathan05
modified: 2017-02-11
categories: Misc Wargame XothSec
comments: true
featured: true
---

# Leviathan05
ssh leviathan5@leviathan.labs.overthewire.org // password _________

### Solution
홈 디렉토리에서 ls -l 명령어를 실행하면 leviathan6 권한으로 setuid가 걸린 바이너리 leviathan5을 찾을 수 있다.

<img src="{{ site.url }}/images/2017-02-11/Leviathan05_01.png" style="display: block; margin: auto;">

leviathan5를 실행해보면 "Cannot find /tmp/file.log"라는 오류메시지가 출력되고 종료된다.

<img src="{{ site.url }}/images/2017-02-11/Leviathan05_02.png" style="display: block; margin: auto;">

gdb로 leviathan5를 분석해보자.

<img src="{{ site.url }}/images/2017-02-11/Leviathan05_03.png" style="display: block; margin: auto;">

오류메시지와 같이 연관지어 생각해보면 /tmp/file.log의 파일을 읽어주는 역활을 하는 것을 알 수 있다.

<img src="{{ site.url }}/images/2017-02-11/Leviathan05_04.png" style="display: block; margin: auto;">

그런 다음 해당 파일을 삭제한다.

<img src="{{ site.url }}/images/2017-02-11/Leviathan05_05.png" style="display: block; margin: auto;">

간단하게 다음 레벨의 password 파일을 /tmp/file.log로 "symbolic link" 하는 것으로 이 문제를 해결할 수 있다.

<img src="{{ site.url }}/images/2017-02-11/Leviathan05_06.png" style="display: block; margin: auto;">
